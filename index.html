<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>FY OP Widget</title>

<style>
body{
  background:black;
  color:#f8ee21;
  font-family: Arial, sans-serif;
  font-weight:bold;
  text-align:center;
  font-size:36px;
  margin-top:40px;
}
</style>
</head>

<body>

<div id="fyop"></div>

<script>

/* -------- FULL OFFICIAL FY OP START TABLE ---------- */
const opTable = [
 {fy:25,op:1,start:"2024-06-03"},
 {fy:25,op:2,start:"2024-07-01"},
 {fy:25,op:3,start:"2024-07-29"},
 {fy:25,op:4,start:"2024-08-26"},
 {fy:25,op:5,start:"2024-09-23"},
 {fy:25,op:6,start:"2024-10-21"},
 {fy:25,op:7,start:"2024-11-18"},
 {fy:25,op:8,start:"2024-12-16"},
 {fy:25,op:9,start:"2025-01-13"},
 {fy:25,op:10,start:"2025-02-10"},
 {fy:25,op:11,start:"2025-03-10"},
 {fy:25,op:12,start:"2025-04-07"},
 {fy:25,op:13,start:"2025-05-05"},

 {fy:26,op:1,start:"2025-06-02"},
 {fy:26,op:2,start:"2025-06-30"},
 {fy:26,op:3,start:"2025-07-28"},
 {fy:26,op:4,start:"2025-08-25"},
 {fy:26,op:5,start:"2025-09-22"},
 {fy:26,op:6,start:"2025-10-20"},
 {fy:26,op:7,start:"2025-11-17"},
 {fy:26,op:8,start:"2025-12-15"},
 {fy:26,op:9,start:"2026-01-12"},
 {fy:26,op:10,start:"2026-02-09"},
 {fy:26,op:11,start:"2026-03-09"},
 {fy:26,op:12,start:"2026-04-06"},
 {fy:26,op:13,start:"2026-05-04"},

 /* Continue rest if desired */
];

/* ---------- EST + 2PM BUSINESS DAY ---------- */
function getBusinessDate(){

  const now = new Date();

  const est = new Date(
    now.toLocaleString("en-US",{timeZone:"America/New_York"})
  );

  if(est.getHours() < 14){
      est.setDate(est.getDate()-1);
  }

  return est;
}

/* ---------- FIND CURRENT OP ---------- */
function getCurrentOP(date){

  for(let i=opTable.length-1;i>=0;i--){
      if(date >= new Date(opTable[i].start)){
          return opTable[i];
      }
  }
  return opTable[0];
}

/* ---------- CALCULATE OP DAY ---------- */
function getOPDay(date, start){

  return Math.floor((date - new Date(start)) / 86400000) + 1;
}

/* ---------- CALCULATE WEEK + WEEKDAY ---------- */
function getWeekDayData(opDay, estNow){

  const week = Math.floor((opDay-1)/7)+1;

  let weekday = (estNow.getDay()+6)%7;

  if(estNow.getDay()===1 && estNow.getHours()<14){
      weekday = 0;
  }else{
      weekday = weekday + 1;
  }

  return {week, weekday};
}

/* ---------- UPDATE DISPLAY ---------- */
function update(){

  const businessDate = getBusinessDate();

  const estNow = new Date(
    new Date().toLocaleString("en-US",{timeZone:"America/New_York"})
  );

  const op = getCurrentOP(businessDate);

  const opDay = getOPDay(businessDate, op.start);

  const weekData = getWeekDayData(opDay, estNow);

  document.getElementById("fyop").innerHTML =
   "FY"+op.fy+
   " OP"+op.op+
   " Week "+weekData.week+
   " Day "+weekData.weekday;
}

update();
setInterval(update,60000);

</script>
</body>
</html>
